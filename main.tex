\documentclass[12pt]{article}

%%%%%%%%%%%%%%%%%%%%%%%% Balíky %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[czech]{babel} 
\usepackage{amsmath, amsfonts, amssymb, amsthm}
\usepackage{graphicx}
\usepackage{booktabs} % Pre profesionálne vyzerajúce tabuľky
\usepackage{geometry}
\geometry{a4paper, margin=2.5cm}
\usepackage[colorlinks=true, linkcolor=black, citecolor=red]{hyperref}
\usepackage{titlesec}
\titleformat{\section}{\large\bfseries}{\thesection}{1em}{}
\usepackage{lmodern} 
%\usepackage{newtxtext,newtxmath}
%\usepackage{microtype}
\usepackage{pgfplots}
\usepackage{float}
\usepackage{multirow}
\usepackage{subcaption}
\usepackage{verbatim}
\usepackage{float}


\pgfplotsset{compat=1.18}
\usetikzlibrary{arrows.meta}

%%%%%%%%%%%%%%%%%%%%%%% Obsah %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{tocloft}
\renewcommand{\cftsecdotsep}{\cftdotsep}
\renewcommand{\cfttoctitlefont}{\Large\bfseries}
\renewcommand{\cftaftertoctitle}{\vspace{0.5cm}}
\setlength{\cftsecindent}{0pt}      % Sekcia bez odsadenia
\setlength{\cftsubsecindent}{1.5em} % Podsekcia odsadená
\setlength{\cftsubsubsecindent}{3em} % Podpodsekcia odsadená viac
\renewcommand{\cftsecpagefont}{\normalfont}
\renewcommand{\cftsubsecpagefont}{\normalfont}




%%%%%%%%%%%%%%%%%%%%% Okraje a Odsadeni %%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\geometry{
    a4paper,
    total={170mm,257mm},
    left=2.5cm,
    right=2.5cm,
    top=5cm,      % Toto spraví ten veľký odskok zhora ako v PDF
    bottom=5cm    % Spodný okraj pre číslovanie
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\begin{titlepage}
    \centering
    \vspace*{2cm} % Odsadenie zhora, aby bol hlavný názov približne v strede hornej polovice

    % Hlavný názov
    {\huge Projekt – numerické metódy v $\mathbb{R}$ a $\mathbb{R}^n$ \par}
    
    \vspace{0.8cm} % Medzera medzi názvom a predmetom
    
    % Názov predmetu - stredne veľké písmo
    {\Large Matematické programovanie (M5170) \par}
    
    \vspace{0.8cm} % Väčšia medzera pred menami autorov
    
    % Mená autorov 
    {\large Ján Húska, Radim Čech \par}
    
    \vfill % Vyplnenie miesta, aby sa číslo strany dostalo na spodok

    % Číslo strany na titulnom liste 
    \vfill % Toto vytlačí zvyšok textu úplne na spodok strany
    
    % Dátum a číslo strany
    {\large január 2026 \par}
    \vspace{0.5cm}
    {\large 1 \par}
\end{titlepage}


\pagenumbering{arabic}
\setcounter{page}{2}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%Obsah 
\tableofcontents
\newpage


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Analýza numerických metód pre funkciu jednej premennej}

Na analýzu správania numerických metód pre funkciu jednej premennej sme si zvolili funkciu
$$ f(x) = (x-2)^2 + \frac{1}{2}\sin(3x) - \frac{1}{3}\cos(2x) + 1, $$
ktorá je spojitá na celom $\mathbb{R}$. Svoje „presné“ minimum táto funkcia nadobúda v bode
$$ x^* \doteq 1{,}74261110151914722 $$
s funkčnou hodnotou
$$ f(x^*) \doteq 0{,}9450058166282782830. $$
Zvolená funkcia pozostáva z kvadratického člena a goniometrických zložiek, čo jej dodáva charakteristický priebeh v tvare vlnitej paraboly. Dominantný vplyv kvadratickej časti zabezpečuje, že oscilácie trigonometrických členov nenarúšajú celkový trend a funkcia si v širšom okolí minima zachováva unimodalitu. Tiež vidíme, že pre jej deriváciu platí $f'(x) = 2(x - 2) + \frac{3}{2}\cos(3x) + \frac{2}{3}\sin(2x)$. Keďže rovnica $f'(x) = 0$ je transcendentná a nemá analytické riešenie, predstavuje táto funkcia vhodný testovací model pre porovnanie efektívnosti numerických metód.
Na nasledujúcej strane je vykreslený graf tejto funkcie pre obmedzený rozsah hodnôt $x$ a $y$.

Pre tento projekt sme vybrali \textbf{metódu rozpoľovania intervalu} a \textbf{metódu zlatého rezu}, ktorých správanie budeme na tejto funkcii skúmať.\footnote{Na analýzu numerických metód v $\mathbf{R}$ používame MapleCloud skripty z https://www.math.muni.cz/~zemanekp/vyuka.html}



\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% --- 4. STRANA: GRAF FUNKCIE 
\thispagestyle{plain}
\vspace*{\fill} 

\begin{figure}[h!]
    \centering
    \begin{tikzpicture}
        \begin{axis}[
            width=16cm, height=12cm,    % ZVÄČŠENIE GRAFU na maximum strany
            axis lines=middle,
            xlabel={$x$}, ylabel={$f(x)$},
            xlabel style={at={(ticklabel* cs:1)}, anchor=north west},
            ylabel style={at={(ticklabel* cs:1)}, anchor=south west},
            xmin=-2.5, xmax=6.5,
            ymin=-2, ymax=18,
            grid=major,
            grid style={dotted, gray!50},
            domain=-2.2:6.2,
            samples=200,
            trig format plots=rad,
            legend style={at={(0.95,0.95)}, anchor=north east, draw=none, fill=none},
            tick label style={font=\footnotesize}
        ]
            
            % 1. Funkcia
            \addplot[color=blue!80!black, thick] 
            { (x-2)^2 + 0.5*sin(3*x) - (1/3)*cos(2*x) + 1 };
            \addlegendentry{$f(x)$}

            % 2. Minimum (bodka)
            \addplot[mark=*, color=red, mark size=2.5pt, only marks] 
            coordinates {(1.7876, 0.9959)};

            % 3. Vodiace čiary
            \draw[dashed, gray] (axis cs:1.7876, 0) -- (axis cs:1.7876, 0.9959);
            \draw[dashed, gray] (axis cs:0, 0.9959) -- (axis cs:1.7876, 0.9959);

            % 4. Popis minima 
            \node[
                anchor=west,           % Zarovnanie textu
                fill=white,            % Biele pozadie (aby bol text čitateľný)
                font=\footnotesize,
                inner sep=2pt,         % Odsadenie textu od okraja
                draw=gray!30,          % Jemný rámček (voliteľné)
                rounded corners        % Zaoblené rohy rámčeka
            ] (popis) at (axis cs:2.5, 4) {Minimum $[1{,}7426; 0{,}9450]$};

            % Šípka od popisu k bodu (aby bolo jasné, kam patrí)
            \draw[->, gray, thick, shorten >=2pt] (popis.south west) -- (axis cs:1.85, 1.1);

        \end{axis}
    \end{tikzpicture}
    \caption{Graf funkcie $ f(x) = (x-2)^2 + \frac{1}{2}\sin(3x) - \frac{1}{3}\cos(2x) + 1. $}
\end{figure}

\vspace*{\fill}
\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Metóda rozpoľovania intervalu}

\subsubsection{Analýza správania metódy pri rôznych hodnotách počtu vyčíslení}

Najprv preskúmame vplyv počtu vyčíslení na presnosť riešenia. Konkrétne zvolíme $N \in \{4, 10, 20, 50, 100\}$, keďže použitá metóda je definovaná pre párny počet funkčných hodnôt.


V tejto časti analýzy sa zameriame na to, ako voľba počtu vyčíslení $N$ ovplyvňuje výslednú presnosť riešenia. Aby sme mohli objektívne sledovať vplyv parametra $N$, pre túto sériu výpočtov zafixujeme počiatočný interval. Vychádzame z faktu, že hľadané minimum sa nachádza v bode $x^* \doteq 1{,}7456125$, preto volíme interval $I_0 = [-6; 10]$. Tento rozsah je voči bodu minima približne symetrický. Z metodického hľadiska je dôležité, aby bod optima neležal v bezprostrednej blízkosti krajov intervalu. Ak by sme totiž zvolili počiatočné ohraničenie s krajným bodom blízko $x^*$, algoritmus by vykonával takmer výlučne jednostrannú kontrakciu intervalu, čo by mohlo skresliť sledované správanie metódy. Navyše, v praxi presnú polohu minima vopred nepoznáme, preto je voľba intervalu, kde sa riešenie nachádza hlbšie v jeho vnútri, realistickejším predpokladom. 


Pre korektné fungovanie algoritmu je potrebné definovať aj parameter $\delta$, určujúci vzdialenosť testovacích bodov od stredu intervalu. Teoretická podmienka $\delta < \frac{1}{2}(b-a) = 8$ je v našom prípade splnená voľbou $\delta = 0{,}01$. Ak by sme zvolili parameter $\delta$ príliš malý, hrozilo by, že funkčné hodnoty v testovacích bodoch budú v rámci numerickej presnosti takmer identické. To by mohlo skomplikovať rozhodovanie o smere ďalšieho kroku. Na druhej strane je naším cieľom držať $\delta$ na čo najnižšej úrovni, aby bola metóda efektívna a výsledný interval lokalizácie minima (ILM) bol čo najužší. Práve preto sme zvolili hodnotu $\delta = 0{,}01$. Považujeme ju za rozumný kompromis – je dostatočne malá na to, aby výsledný interval čo najtesnejšie ohraničoval minimum, no zároveň poskytuje dostatočný odstup na to, aby algoritmus vedel spoľahlivo určiť smer ďalšieho kroku. Pri tomto nastavení môžeme v nasledujúcej časti objektívne porovnať, ako sa mení presnosť výsledkov pri rôznom počte vyčíslení $N$, pričom všetky ostatné vstupné parametre zostávajú rovnaké.

\vspace{0.5cm}

\noindent \underline{\textbf{N = 4}}

\vspace{0.5cm}
Pre $N=4$ vyčíslení (2 kroky) dostávame výsledný ILM približne ako $I_2 = [-2{,}005; 2{,}01]$ a apriórny odhad maximálnej chyby je $\epsilon_{max} \doteq 2{,}0075$. Aproximáciu minima dostávame ako bod $\tilde{x} \doteq 0{,}0025$ s funkčnou hodnotou $f(\tilde{x}) \doteq 4{,}660427048$. Skutočná chyba je potom $\epsilon \doteq 1{,}740111102$. Vidíme, že po iba dvoch krokoch metódy je chyba stále značná, čo je vzhľadom na šírku pôvodného intervalu očakávateľné. 

\newpage

\noindent \underline{\textbf{N = 10}}

\vspace{0.5cm}

Pre $N=10$ vyčíslení dostávame výsledný ILM približne ako $I_5 = [1{,}490625; 2{,}01]$ a apriórny odhad maximálnej chyby je $\epsilon_{max} \doteq 0{,}2596875$. Aproximáciu minima dostávame ako bod $\tilde{x} \doteq 1{,}7503125$ s funkčnou hodnotou $f(\tilde{x}) \doteq 0{,}945195918$. Skutočná chyba je potom $\epsilon \doteq 0{,}007701398$. 

Zaujímavým zistením je rádový pokles skutočnej chyby medzi $N=4$ a $N=10$. Zatiaľ čo pri dvoch krokoch ($N=4$) sa aproximácia nachádzala ešte v časti intervalu s chybou v rádoch jednotiek ($\epsilon \approx 1{,}74$), po piatich krokoch ($N=10$) klesla skutočná chyba o tri rády na úroveň tisícin ($\epsilon \approx 0{,}0077$). Tento vyše 200-násobný nárast presnosti demonštruje, že po počiatočnej fáze hrubej lokalizácie začína metóda veľmi efektívne konvergovať k stacionárnemu bodu. 

\vspace{0.5cm}

\noindent \underline{\textbf{N = 20}}

\vspace{0.5cm}
Pre $N=20$ vyčíslení dostávame výsledný ILM ako $I_{10} = [1{,}724707031; 1{,}7603125]$ a apriórny odhad maximálnej chyby klesá pod $0{,}0178027$. Aproximáciu minima dostávame ako bod $\tilde{x} \doteq 1{,}742509766$ s funkčnou hodnotou $f(\tilde{x}) \doteq 0{,}9959$. Skutočná chyba je $\epsilon \doteq 0{,}000101336$. 

Vidíme, že algoritmus už prekonal fázu „hľadania“ v širokom počiatočnom intervale a plne sa stabilizoval v konvexnej oblasti funkcie. Zaujímavým javom je, že hoci sa dĺžka intervalu stále zmenšuje podľa teoretického predpokladu, začíname narážať na spodnú hranicu presnosti určenú parametrom $\delta = 0{,}01$.
\vspace{0.5cm}

\noindent \underline{\textbf{N = 50}}

\vspace{0.5cm}

Pre $N=50$ vyčíslení dostávame výsledný interval približne ako 
$I_{25} = [1{,}732631684; \allowbreak 1{,}752632160]$ a apriórny odhad maximálnej chyby je $\epsilon_{max} \doteq 0{,}010000023812$. Aproximáciu minima dostávame ako bod $\tilde{x} \doteq 1{,}742631922$ s funkčnou hodnotou $f(\tilde{x}) \doteq 0{,}9450581673$. Skutočná chyba je potom $\epsilon \doteq 0{,}000020820480852$. 

Vidíme, že aproximácia sa spresnila na úroveň piatich desatinných miest ($10^{-5}$). Hoci je odhad chyby $\epsilon_{max}$ stále na úrovni $0{,}01$, reálna poloha minima $\tilde{x} \doteq 1{,}74263$ je už veľmi blízko skutočnému minimu funkcie. Funkčná hodnota $f(\tilde{x}) \doteq 0{,}945058$ taktiež zaznamenala pokles a ustálila sa v tesnej blízkosti globálneho minima.
Možno konštatovať, že akékoľvek ďalšie navyšovanie počtu vyčíslení pri zachovaní $\delta = 0{,}01$ už nepovedie k zmenšeniu apriórnej chyby, pretože tá je limitovaná samotnou konštrukciou metódy, nie počtom iterácií. Tento stav demonštruje vysokú efektivitu výpočtu, no zároveň odhaľuje jeho presnostný strop. Ďalej sa naskytuje otázka, či je vôbec potrebné učiniť väčšie vyčíslenia, pretože si tým už pravdepodobne moc neprilepšíme.
\vspace{0.5cm}

\noindent \underline{\textbf{N = 100}}

\vspace{0.5cm}
Pre $N=100$ dostávame výsledný ILM približne ako $I_{50} = [1{,}732631689; 1{,}752631690]$ a apriórny odhad maximálnej chyby je $\epsilon_{max} \doteq 0{,}0100000000$. Aproximáciu minima dostávame ako bod $\tilde{x} \doteq 1{,}742631690$ s funkčnou hodnotou $f(\tilde{x}) \doteq 0{,}9450581673$. Skutočná chyba je potom $\epsilon \doteq 0{,}00002058848085$. 

Výsledky pre 100 vyčíslení vykazujú takmer úplnú identitu s predchádzajúcim meraním. Apriórny odhad maximálnej chyby dosiahol svoju limitnú hodnotu $\epsilon_{max} \doteq 0{,}01$, čo exaktne zodpovedá zvolenému parametru $\delta$. Skutočná chyba $\epsilon \doteq 0{,}00002058$ sa oproti $N=50$ zmenila až na deviatom desatinnom mieste, čo je z hľadiska praktickej numerickej analýzy zanedbateľný posun. Z hľadiska efektivity výpočtu môžeme konštatovať, že pre danú funkciu a konfiguráciu parametrov je $N=100$ už neefektívnym „overkillom“. 

V nadväznosti na doterajšie pozorovania sa v ďalšej analýze obmedzíme na dve reprezentatívne hodnoty $N=10$ a $N=50$. Tento výber nám umožňuje sledovať dostatočný kontrast v presnosti bez zbytočnej redundancie výpočtov. Zatiaľ čo $N=10$ reprezentuje fázu úspešnej počiatočnej lokalizácie minima, hodnota $N=50$ už predstavuje dosiahnutie praktického limitu presnosti algoritmu pri zvolenej hodnote $\delta$.

Pre zaujímovosť (bez slovnej analýzy) ešte uvádzame tabuľku pre rôzne hodnoty parametru delta $\delta:$

\begin{figure}[H]
    \centering
    \includegraphics[width=0.65\textwidth]{grafy/vhyna.png}
    \label{fig:moj_obrazok}
\end{figure}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{Analýza správania metódy pri rôznych východiskových intervaloch lokalizácie minima}

V nasledujúcej časti zanalyzujeme vplyv šírky počiatočného intervalu na celkovú presnosť lokalizácie optima pri $\delta=0,01$. Náš pôvodný interval $I_0 = [-6; 10]$ budeme rôzne modifikovať. Najskôr ho zúžime na polovicu (t.j. $[-3; 5]$) a následne ho v dvakrát rozšírime (t.j. $[-12; 20]$). Motiváciou pre tento experiment je štruktúra apriórneho odhadu chyby, ktorý vykazuje priamu závislosť od vstupnej dĺžky intervalu $(b-a)$. Zo vzťahu pre dĺžku výsledného intervalu po $k$ krokoch $$l_k = \frac{b-a}{2^k} + \delta \frac{2^k - 1}{2^{k-1}}$$je zrejmé, že redukcia šírky počiatočného intervalu by mala pri konštantnom $N$ viesť k vyššej presnosti, zatiaľ čo jeho rozšírenie bude mať za následok nárast chyby aproximácie. 

Ďalej sa pozrieme na ďalšie iné zmeny, ako je napríklad nesymetrický interval s minimom pri okraji $I_{asym1} = [ 1{,}7; 15 ]$, nesymetrickým intervalom s minimom mimo okraja $I_{asym2} = [ -6; 21 ]$, mikro intervalom $I_{micro} = [ 1{,}73; 1{,}76 ]$ a obrovským intervalom $I_{giant} = [ -100; 100 ]$.
\newpage

\noindent \underline{\textbf{Kratší počiatočný interval}}
\vspace{0.5cm}

Pre východiskový interval $I_0 = [-3; 5]$ a $N=10$ vyčíslení dostávame výsledný ILM približne ako $I_5 = [1{,}48875; 1{,}7584125]$. Apriórny odhad maximálnej chyby je $\epsilon_{max} \doteq 0{,}1346875$. Aproximáciu minima dostávame ako bod $\tilde{x} \doteq 1{,}62334375$ s funkčnou hodnotou $f(\tilde{x}) \doteq 0{,}9795089721$. Skutočná chyba je v tomto prípade $\epsilon \doteq 0{,}1191736015$.

\vspace{0.3cm}

Pre východiskový interval $I_0 = [-3; 5]$ a $N=50$ vyčíslení dostávame výsledný ILM približne ako $I_5 = [1{,}732631536; 1{,}752631774]$. Apriórny odhad maximálnej chyby je $\epsilon_{max} \doteq 0{,}0100001$. Aproximáciu minima dostávame ako bod $\tilde{x} \doteq 1{,}742631655$ s funkčnou hodnotou $f(\tilde{x}) \doteq 0{,}9450581673$. Skutočná chyba je v tomto prípade $\epsilon \doteq 0{,}000020553$.

\vspace{0.3cm}

Ak porovnáme výsledky pre $N = 10$, vidíme, že zmenšenie intervalu na polovicu nám znížilo apriórnu chybu o cca $0{,}125$, čo je pri takom malom počte krokov naozaj výrazný posun k lepšiemu. Naopak pri $N = 50$ je už rozdiel medzi pôvodným a týmto kratším intervalom prakticky nulový (rozdiel je len v rádoch $10^{-8}$), pretože v tomto bode už vplyv počiatočnej šírky intervalu vo vzorci pre $\ell_k$ takmer úplne zaniká v prospech zvolenej delty. Z týchto meraní je teda jasné, že snažiť sa o čo najužší počiatočný interval má zmysel hlavne vtedy, keď chceme minimum nájsť rýchlo na pár krokov, zatiaľ čo pri dlhšom výpočte sa táto počiatočná výhoda postupne úplne vytráca.

\vspace{0.5cm}
\noindent \underline{\textbf{Dlhší počiatočný interval}}
\vspace{0.5cm}


Pre východiskový interval $I_0 = [-12; 20]$ a $N=10$ vyčíslení dostávame výsledný ILM približne ako $I_5 = [0{,}991875; 2{,}01125]$. Apriórny odhad maximálnej chyby je $\epsilon_{max} \doteq 0{,}5096875$. Aproximáciu minima dostávame ako bod $\tilde{x} \doteq 1{,}5015625$ s funkčnou hodnotou $f(\tilde{x}) \doteq 1{,}089329089$. Skutočná chyba je v tomto prípade $\epsilon \doteq 0{,}241048601$.


\vspace{0.3cm}

Pre východiskový interval $I_0 = [-12; 20]$ a $N=50$ vyčíslení dostávame výsledný ILM približne ako $I_5 = [1{,}732631257; 1{,}752632210]$. Apriórny odhad maximálnej chyby je $\epsilon_{max} \doteq 0{,}0100005$. Aproximáciu minima dostávame ako bod $\tilde{x} \doteq 1{,}742631734$ s funkčnou hodnotou $f(\tilde{x}) \doteq 0{,}9450581672$. Skutočná chyba je v tomto prípade $\epsilon \doteq 0{,}000020632$.

\vspace{0.3cm}

To potvrdzuje teoretický predpoklad, že ak o polohe minima nič nevieme a musíme zvoliť široký interval, zaplatíme za to nižšou presnosťou alebo nutnosťou vyššieho počtu iterácií.
Pre N=10 je výsledný interval neistoty podstatne širší v porovnaní s kratším počiatočným intervalom a skutočná chyba nadobúda vyššie hodnoty, hoci stále zostáva menšia než apriórny odhad maximálnej chyby. Pri zvýšení počtu vyčíslení na N=50 však dochádza k výraznému zlepšeniu presnosti a výsledný interval sa prakticky zhoduje s výsledkami získanými pre kratší počiatočný interval.

\vspace{0.5cm}
\noindent \underline{\textbf{Nesymetrický východiskový interval s minimom pri okraji}}
\vspace{0.5cm}


Zameráme sa teraz na interval, ktorého jeden z krajných bodov nie je od skutočného bodu minima príliš ďaleko, teda na $I_0 = [1.7; 15]$. V úvode sme spomínali, že takýto interval sa bude pri metóde prevažne skracovať z jednej strany.

\vspace{0.3cm}

Pre východiskový interval $I_0 = [1.7; 15]$ a $N=10$ vyčíslení dostávame výsledný ILM približne ako $I_5 = [1{,}7; 2{,}135]$. Apriórny odhad maximálnej chyby je $\epsilon_{max} \doteq 0{,}2175$. Aproximáciu minima dostávame ako bod $\tilde{x} \doteq 1{,}9175$ s funkčnou hodnotou $f(\tilde{x}) \doteq 1{,}010101541$. Skutočná chyba je v tomto prípade $\epsilon \doteq 0{,}174888984793$.

\vspace{0.3cm}

Pre východiskový interval $I_0 = [1.7; 15]$ a $N=50$ vyčíslení dostávame výsledný ILM približne ako $I_5 = [1{,}732631636; 1{,}752632032]$. Apriórny odhad maximálnej chyby je $\epsilon_{max} \doteq 0{,}0100001$. Aproximáciu minima dostávame ako bod $\tilde{x} \doteq 1{,}742631834$ s funkčnou hodnotou $f(\tilde{x}) \doteq 0{,}9450581673$. Skutočná chyba je v tomto prípade $\epsilon \doteq 0{,}0000207324$.

\vspace{0.3cm}

Hoci bol ľavý krajný bod už od začiatku vynikajúcim odhadom, pri $N=10$ sme stále skončili s chybou okolo 0,22. Je to jasný dôkaz toho, že algoritmus o skutočnej polohe minima na začiatku „netuší“ a musí sa k nemu aj tak postupne prepracovať cez postupné skracovanie dlhej pravej strany intervalu. Opäť sa nám však potvrdilo, že pri $N=50$ sme narazili na ten istý presnostný strop 0,01 ako v predchádzajúcich prípadoch. Ukazuje sa teda, že ani takáto výrazná nápoveda na štarte nepomôže metóde prekonať jej vlastné limity. Bez ohľadu na to, ako veľmi asymetricky začneme, metóda sa pri dostatočnom počte vyčíslení vždy ustáli na rovnakom výslednom ILM, ktorý je pevne daný našou hodnotou delta.

\vspace{0.5cm}
\noindent \underline{\textbf{Nesymetrický východiskový interval s minimom ďalej od okraja} }
\vspace{0.5cm}


Pre východiskový interval $I_0 = [-6; 21]$ a $N=10$ vyčíslení dostávame výsledný ILM približne ako $I_5 = [1{,}588125; 2{,}45125]$. Apriórny odhad maximálnej chyby je $\epsilon_{max} \doteq 0{,}4315625$. Aproximáciu minima dostávame ako bod $\tilde{x} \doteq 2{,}0196875$ s funkčnou hodnotou $f(\tilde{x}) \doteq 1{,}097043863$. Skutočná chyba je v tomto prípade $\epsilon \doteq 0{,}27707639848$.

\vspace{0.3cm}

Pre východiskový interval $I_0 = [-6; 21]$ a $N=50$ vyčíslení dostávame výsledný ILM približne ako $I_5 = [1{,}732631056; 1{,}752631860]$. Apriórny odhad maximálnej chyby je $\epsilon_{max} \doteq 0{,}0100004$. Aproximáciu minima dostávame ako bod $\tilde{x} \doteq 1{,}742631458$ s funkčnou hodnotou $f(\tilde{x}) \doteq 0{,}9450581672$. Skutočná chyba je v tomto prípade $\epsilon \doteq 0{,}00002035648$.

\vspace{0.3cm}

Pri tomto meraní sme interval natiahli na šírku 27 a posunuli ho asymetricky doprava. Z výsledkov pre $N=10$ jasne vidíme, že čím je ten počiatočný rozsah širší, tým horšie sme na tom s presnosťou v prvých krokoch. Napriek tomu, že minimum tentokrát neleží v strede, algoritmus stále efektívne pracuje a vďaka dostatočnému počtu krokov pri $N=50$ nás opäť dostal na našu hranicu $0{,}01$. Je to ďalší dôkaz toho, že táto metóda je mimoriadne robustná. Aj keď na začiatku zvolíme interval trochu náhodne alebo nesymetricky, s pribúdajúcimi vyčísleniami sa tieto počiatočné nedostatky úplne vymažú a výsledok skončí v podstate v rovnakej kvalite ako pri ideálnom symetrickom zadaní.

\vspace{0.5cm}
\noindent \underline{\textbf{Mikro interval} }
\vspace{0.5cm}

Pre východiskový interval $I_{micro} = [ 1{,}73; 1{,}76 ]$ a $N=10$ vyčíslení dostávame výsledný ILM približne ako $I_5 = [1{,}7325; 1{,}7528125]$. Apriórny odhad maximálnej chyby je $\epsilon_{max} \doteq 0{,}01015625$. Aproximáciu minima dostávame ako bod $\tilde{x} \doteq 1{,}74265625$ s funkčnou hodnotou $f(\tilde{x}) \doteq 0{,}9450581711$. Skutočná chyba je v tomto prípade $\epsilon \doteq 0{,}000045162313$.

\vspace{0.3cm}

Pre východiskový interval $I_{micro} = [ 1{,}73; 1{,}76 ]$ a $N=50$ vyčíslení dostávame výsledný ILM približne ako $I_5 = [1{,}732631689; 1{,}752631690]$. Apriórny odhad maximálnej chyby je $\epsilon_{max} \doteq 0{,}0100000$. Aproximáciu minima dostávame ako bod $\tilde{x} \doteq 1{,}742631690$ s funkčnou hodnotou $f(\tilde{x}) \doteq 0{,}9450581673$. Skutočná chyba je v tomto prípade $\epsilon \doteq 0{,}000020602313$.

\vspace{0.3cm}

Je veľmi zaujímavé sledovať, že pri takto úzkom štarte sme sa s apriórnou chybou dostali na úroveň našej delty ($0{,}01$) už pri $N=10$. V podstate to znamená, že metóda „vyriešila“ svoju úlohu hneď v prvých pár krokoch a zvyšných 40 vyčíslení pri $N=50$ už bolo úplne zbytočných, keďže nepriniesli žiadne reálne zlepšenie odhadu chyby.

\vspace{0.5cm}
\noindent \underline{\textbf{Obrovský interval}}
\vspace{0.5cm}

Pre východiskový interval $I_0 = [-100; 100]$ a $N=10$ vyčíslení dostávame výsledný ILM približne ako $I_5 = [-0{,}01; 6{,}259375]$. Apriórny odhad maximálnej chyby je $\epsilon_{max} \doteq 3{,}1346875$. Aproximáciu minima dostávame ako bod $\tilde{x} \doteq 3{,}1246875$ s funkčnou hodnotou $f(\tilde{x}) \doteq 1{,}957126$. Skutočná chyba je v tomto prípade $\epsilon \doteq 1{,}382076398$.

\vspace{0.3cm}

Pre východiskový interval $I_0 = [-100; 100]$ a $N=50$ vyčíslení dostávame výsledný ILM približne ako $I_5 = [1{,}732629768; 1{,}752635728]$. Apriórny odhad maximálnej chyby je $\epsilon_{max} \doteq 0{,}0100002$. Aproximáciu minima dostávame ako bod $\tilde{x} \doteq 1{,}742632748$ s funkčnou hodnotou $f(\tilde{x}) \doteq 0{,}9450581674$. Skutočná chyba je v tomto prípade $\epsilon \doteq 0{,}0000216464$.

\vspace{0.3cm}

Pri $N=10$ je zrejmé, že nízky počet krokov na takýto široký interval nestačí, čo potvrdzuje aj pomerne vysoká apriórna chyba presahujúca tri jednotky. Stred intervalu sa v tejto fáze nachádzal len v okolí hodnoty $3{,}12$. Zaujímavý posun však nastáva pri $N=50$. Ukazuje sa, že dĺžka počiatočného intervalu nie je až taká podstatná, pretože pri dostatočnom počte vyčíslení metóda vždy spoľahlivo dosiahne presnosť určenú parametrom $\delta$.

\vspace{0.3cm}

Ďalej si môžeme naše namerané hodnoty zaznamenať do tabuľky pre lepšiu prehľadnosť. 
Dôležité sú najmä hodnoty pre $N=10$, keďže pre $N=50$ boli všetky takmer rovnaké.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\textwidth]{grafy/analyza vplyvu.png}
    \label{fig:moj_obrazok}
\end{figure}
Tabuľka potvrdzuje, že čím širší je počiatočný interval, tým nižšiu presnosť pri rovnakom počte vyčíslení dosahujeme. Zatiaľ čo pri malých rozsahoch je metóda vysoko efektívna, pri extrémnom prípade „Makro“ už narážame na limity algoritmu kvôli nedostatočnému počtu krokov.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% --- METÓDA ZLATÉHO REZU ---
\newpage
\subsection{Metóda zlatého rezu}

Postup pri analýze presnosti zostáva podobný ako v predchádzajúcom prípade. Opäť budeme sledovať, ako voľba počtu vyčíslení $N$ (kde $N \in \{4, 10, 20, 50, 100\}$) ovplyvňuje výsledok, pričom zachováme počiatočný interval $I_0 = [-6; 10]$. Tu už nepracujeme s parametrom $\delta$.

Princíp tejto metódy vychádza práve z metódy polenia intervalu, avšak vhodnou voľbou bodov budeme okrem prvého kroku vyčísľovať vždy iba jeden nový bod. Teda v prípade rovnakého počtu vyčíslení $N$ by sme mali dostať $N-1$ nových intervalov, zatiaľ čo pri MPI dostaneme iba $N/2$.

\subsubsection{Analýza správania metódy pri rôznych hodnotách počtu vyčíslení}

\vspace{0.5cm}
\noindent \underline{\textbf{N=4}}
\vspace{0.5cm}

Pre $N = 4$ vyčíslenia dostávame výsledný ILM ako $I_3 = [0{,}111456165; 3{,}888543802]$ a apriórny odhad maximálnej chyby je $\epsilon_{max} \approx 1{,}888543813$. Aproximáciu minima dostávame ako bod $\tilde{x} \approx 1{,}999999984$ s funkčnou hodnotou $f(\tilde{x}) \approx 1{,}078173443$. Skutočná chyba je potom $\epsilon \approx 0{,}2573888824$.

\vspace{0.3cm}

Zaujímavé je, že náš teoretický odhad apriórnej chyby je podobný ako pri metóde polenia, avšak naša aproximácia minima $\tilde{x} \approx 1{,}9999$ je v tomto prípade až prekvapivo blízko k bodu $2$. To sa odrazilo aj na skutočnej chybe, ktorá je $\epsilon \approx 0{,}257$, čo je v porovnaní s predchádzajúcimi výsledkami výrazné zlepšenie. Ďalším porovnaním dostávame, že pri pri metóde zlatého rezu (MZR) o jeden interval viac oproti MPI (konkrétne 3 oproti 2). Pri takto malých hodnotách vyčíslení každý nový krok prináša zlepšenie.


\vspace{0.5cm}
\noindent \underline{\textbf{N=10}} 
\vspace{0.5cm}

Pre $N = 10$ vyčíslenia dostávame výsledný ILM ako $I_9 = [1{,}684265159; 1{,}894755039]$ a apriórny odhad maximálnej chyby je $\epsilon_{max} \approx 0{,}1052449388$. Aproximáciu minima dostávame ako bod $\tilde{x} \approx 1{,}789510$ s funkčnou hodnotou $f(\tilde{x}) \approx 0{,}95007804$. Skutočná chyba je potom $\epsilon \approx 0{,}046898997$.

\vspace{0.3cm}

Pri desiatich vyčísleniach metóda zlatého rezu výrazne pokročila. Apriórny odhad maximálnej chyby klesol na $\epsilon_{max} \approx 0{,}105$, čo je v porovnaní s počiatočným stavom ($N=4$) takmer 18-násobné spresnenie. Aproximácia minima $\tilde{x} \approx 1{,}7895$ sa už nachádza vo veľmi tesnej blízkosti skutočného minima.
Pri desiatich vyčísleniach vidíme, že zlatý rez má teoreticky navrch, pretože vďaka recyklovaniu bodov stihol urobiť až deväť krokov, zatiaľ čo metóda polenia len päť. Zaujímavé však je, že hoci má zlatý rez lepší apriórny odhad, naša skutočná chyba vyšla pri metóde polenia o niečo lepšie, čo zrejme súvisí s tým, že metóda polenia v každom kroku osekáva interval agresívnejšie a v našom konkrétnom prípade nám to vďaka symetrii vyšlo presnejšie. Zlatý rez je teda síce teoreticky efektívnejší pri využívaní počtu meraní, ale metóda polenia dokáže byť vďaka rýchlejšiemu deleniu intervalu v praxi veľmi silným konkurentom.


\vspace{0.5cm}
\noindent \underline{\textbf{N=20}} 
\vspace{0.5cm}

Pre $N = 20$ vyčíslenia dostávame výsledný ILM ako $I_{19} = [1{,}742262452; 1{,}7436973865]$ a apriórny odhad maximálnej chyby je $\epsilon_{max} \approx 0{,}0008557$. Aproximáciu minima dostávame ako bod $\tilde{x} \approx 1{,}743118158$ s funkčnou hodnotou $f(\tilde{x}) \approx 0{,}9450587651$. Skutočná chyba je potom $\epsilon \approx 0{,}0005070564808$.

\vspace{0.3cm}

Pri dvadsiatich vyčísleniach už metóda zlatého rezu v teoretickej presnosti úplne dominuje, keďže jej apriórny odhad chyby klesol pod hranicu $0{,}001$, čo je v porovnaní s hodnotou $0{,}0178$ pri metóde polenia zjavný rozdiel. Tento náskok je spôsobený tým, že zlatý rez stihol za rovnaký počet meraní urobiť až 19 krokov, kým metóda polenia len 10, vďaka čomu je výsledný interval zlatého rezu nepomerne užší. Aj keď pri skutočnej chybe bola metóda polenia doteraz o niečo lepšia a triafala sa bližšie k optimu, pri $N=20$ už zlatý rez garantuje dostatočnú presnosť na to, aby sme výsledok mohli považovať za veľmi verný odhad skutočného minima.

\vspace{0.5cm}
\noindent \underline{\textbf{N=50}} 
\vspace{0.5cm}

Pre $N = 50$ vyčíslenia dostávame výsledný ILM ako $I_{49} = [1{,}742605919; 1{,}742605920]$ a apriórny odhad maximálnej chyby je $\epsilon_{max} \approx 4{,}599 \times10^{-10}$. Aproximáciu minima dostávame ako bod $\tilde{x} \approx 1{,}742605920$ s funkčnou hodnotou $f(\tilde{x}) \approx 0{,}9450581663$. Skutočná chyba je potom $\epsilon \approx 5{,}1815 \times10^{-6}$.

\vspace{0.3cm}

Pri päťdesiatich vyčísleniach sa naplno prejavila najväčšia slabina metódy polenia v porovnaní so zlatým rezom. Zatiaľ čo metóda polenia pri tomto počte krokov úplne narazila na svoj presnostný strop kvôli parametru delta a jej apriórna chyba sa zasekla na hodnote $0,01$, zlatý rez pokračoval v zmenšovaní intervalu bez akéhokoľvek obmedzenia až na úroveň miliardtín. Tento veľký rozdiel v teoretickej presnosti jasne ukazuje, že zlatý rez je pri vyššom počte meraní neporovnateľne efektívnejší, pretože dokáže z každého jedného vyčíslenia vyťažiť maximum informácie.

\vspace{0.5cm}
\noindent \underline{\textbf{N=100}} 
\vspace{0.5cm}

Pre $N = 100$ vyčíslenia dostávame výsledný ILM ako $I_{99} = [1{,}742605919; 1{,}742605920]$ a apriórny odhad maximálnej chyby je $\epsilon_{max} \approx 1{,}634 \times10^{-20}$. Aproximáciu minima dostávame ako bod $\tilde{x} \approx 1{,}742605920$ s funkčnou hodnotou $f(\tilde{x}) \approx 0{,}9450581663$. Skutočná chyba je potom $\epsilon \approx 5{,}1815 \times10^{-6}$.

\vspace{0.3cm}

Pri sto vyčísleniach sme sa pri zlatom reze dostali k apriórnemu odhadu chyby v rádoch $10^{-20}$, čo je z praktického hľadiska v podstate dokonalá presnosť. Keď si spomenieme, že metóda polenia pri $N=100$ stále beznádejne stála na hodnote $0{,}01$ kvôli obmedzeniu parametrom delta, je jasné, že zlatý rez je pre vysokú presnosť neporovnateľne lepšou voľbou. Je však zaujímavé, že hoci teoretický odhad extrémne klesol, naša skutočná chyba $\epsilon$ sa od merania s $N=50$ už takmer nepohla. To nám napovedá, že sme zrejme narazili na hranicu numerickej presnosti samotného softvéru alebo referenčnej hodnoty minima, ktorú používame na porovnanie.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{Analýza správania metódy pri rôznych východiskových intervaloch lokalizácie minima}

Rovnako ako pri metóde polenia intervalu, aj tu predpokladáme, že dĺžka počiatočného intervalu ILM bude mať priamy vplyv na presnosť výsledkov. Očakávame teda, že pri kratšom intervale dosiahneme lepšie výsledky než pri tom dlhšom, čo si následne overíme na porovnaní pre $N=4$ a $N=20$ vyčíslení. Vyberáme si tieto hodnoty vyčíslenia, pretože na nich bude najlepšie vidieť správanie metódy pri rôznych východiskových, bohužiaľ, nebudeme môct už vhodne porovnávať MPI, keďže tam sme vybrali $N=10$ a $N=50$.

\vspace{0.5cm}
\noindent \underline{\textbf{Kratší počiatočný interval}}
\vspace{0.5cm}

Pre východiskový interval $I_0 = [-3; 5]$ a $N=4$ vyčíslení dostávame výsledný ILM približne ako $I_3 = [1{,}222912349; 3{,}111456173]$. Apriórny odhad maximálnej chyby je $\epsilon_{max} \doteq 0{,}9442719065$. Aproximáciu minima dostávame ako bod $\tilde{x} \doteq 2{,}167184260$ s funkčnou hodnotou $f(\tilde{x}) \doteq 1{,}259295792$. Skutočná chyba je v tomto prípade $\epsilon \doteq 0{,}4245731584$.

\vspace{0.3cm}


Pre východiskový interval $I_0 = [-3; 5]$ a $N=20$ vyčíslení dostávame výsledný ILM približne ako $I_{19} = [1{,}742416242; 1{,}743271948]$. Apriórny odhad maximálnej chyby je $\epsilon_{max} \doteq 0{,}000427853$. Aproximáciu minima dostávame ako bod $\tilde{x} \doteq 1{,}742844095$ s funkčnou hodnotou $f(\tilde{x}) \doteq 0{,}945058292$. Skutočná chyba je v tomto prípade $\epsilon \doteq 0{,}000232993$.

\vspace{0.3cm}

Pri kratšom intervale zlatý rez okamžite profituje z lepšieho štartu, čo vidno na polovičnej chybe hneď pri štyroch vyčísleniach. To v podstate znamená, že kombinácia úzkeho intervalu a zlatého rezu je najefektívnejšia cesta, ako sa bez zbytočných výpočtových bariér dostať k veľmi presnému cieľu.

\vspace{0.5cm}
\noindent \underline{\textbf{Dlhší počiatočný interval}}
\vspace{0.5cm}

Pre východiskový interval $I_0 = [-12; 20]$ a $N=4$ vyčíslení dostávame výsledný ILM približne ako $I_3 = [0{,}222912326; 7{,}77708762]$. Apriórny odhad maximálnej chyby je $\epsilon_{max} \doteq 3{,}777087626$. Aproximáciu minima dostávame ako bod $\tilde{x} \doteq 3{,}9999999$ s funkčnou hodnotou $f(\tilde{x}) \doteq 4{,}780213392$. Skutočná chyba je v tomto prípade $\epsilon \doteq 2{,}25738871$.

\vspace{0.3cm}

Pre východiskový interval $I_0 = [-12; 20]$ a $N=20$ vyčíslení dostávame výsledný ILM približne ako $I_{19} = [1{,}740493152; 1{,}743915977]$. Apriórny odhad maximálnej chyby je $\epsilon_{max} \doteq 0{,}001711412926$. Aproximáciu minima dostávame ako bod $\tilde{x} \doteq 1{,}742204564$ s funkčnou hodnotou $f(\tilde{x}) \doteq 0{,}9450585514$. Skutočná chyba je v tomto prípade $\epsilon \doteq 0{,}000406537519147$.

\vspace{0.3cm}

Aj pri takto širokom počiatočnom intervale (šírka 32) vidíme, že hoci je odhad pri $N=4$ ešte pomerne hrubý, s pribúdajúcimi krokmi sa metóda dokáže s touto neistotou vysporiadať veľmi efektívne. Už pri $N=20$ sme dosiahli apriórnu chybu $0{,}0017$, čo predstavuje takmer desaťkrát lepší výsledok, než aký vykazovala metóda polenia pri polovičnom (a teda jednoduchšom) intervale. Opäť sa nám tak potvrdilo, že zlatý rez pracuje pri veľkých rozsahoch oveľa výkonnejšie a z každého vykonaného vyčíslenia dokáže vyťažiť maximum informácií o polohe minima.

\vspace{0.5cm}
\noindent \underline{\textbf{Nesymetrický východiskový interval s minimom pri okraji}} 
\vspace{0.5cm}

Pre východiskový interval $I_0 = [1.7; 15]$ a $N=4$ vyčíslení dostávame výsledný ILM približne ako $I_3 = [1{,}7; 4{,}839704089]$. Apriórny odhad maximálnej chyby je $\epsilon_{max} \doteq 1{,}569852044$. Aproximáciu minima dostávame ako bod $\tilde{x} \doteq 3{,}269852044$ s funkčnou hodnotou $f(\tilde{x}) \doteq 2{,}102421088$. Skutočná chyba je v tomto prípade $\epsilon \doteq 1{,}527240942$.

\vspace{0.3cm}

Pre východiskový interval $I_0 = [1.7; 15]$ a $N=20$ vyčíslení dostávame výsledný ILM približne ako $I_{19} = [1{,}742183968; 1{,}743606580]$. Apriórny odhad maximálnej chyby je $\epsilon_{max} \doteq 0{,}000711306$. Aproximáciu minima dostávame ako bod $\tilde{x} \doteq 1{,}742895274$ s funkčnou hodnotou $f(\tilde{x}) \doteq 0{,}9450583544$. Skutočná chyba je v tomto prípade $\epsilon \doteq 0{,}0002841724793$.

\vspace{0.3cm}

Pri nesymetrickom intervale s minimom blízko okraja sa pri malom počte vyčíslení výrazne znižuje presnosť aproximácie a výsledný interval zostáva široký. Zvýšením počtu vyčíslení sa však metóda rýchlo stabilizuje a poskytuje veľmi presný odhad minima. Tento prípad poukazuje na citlivosť metódy na polohu minima v počiatočnom intervale.

\vspace{0.5cm}
\noindent \underline{\textbf{Nesymetrický východiskový interval s minimom ďalej od okraja}}
\vspace{0.5cm}

Pre východiskový interval $I_0 = [-6; 21]$ a $N=4$ vyčíslení dostávame výsledný ILM približne ako $I_3 = [-2{,}060753108; 4{,}31308228]$. Apriórny odhad maximálnej chyby je $\epsilon_{max} \doteq 3{,}1869178684$. Aproximáciu minima dostávame ako bod $\tilde{x} \doteq 1{,}126164586$ s funkčnou hodnotou $f(\tilde{x}) \doteq 1{,}856237351$. Skutočná chyba je v tomto prípade $\epsilon \doteq 0{,}6164465$.

\vspace{0.3cm}

Pre východiskový interval $I_0 = [-6; 21]$ a $N=20$ vyčíslení dostávame výsledný ILM približne ako $I_{19} = [1{,}741033938; 1{,}743921948]$. Apriórny odhad maximálnej chyby je $\epsilon_{max} \doteq 0{,}001444004$. Aproximáciu minima dostávame ako bod $\tilde{x} \doteq 1{,}742477943$ s funkčnou hodnotou $f(\tilde{x}) \doteq 0{,}09450582075$. Skutočná chyba je v tomto prípade $\epsilon \doteq 0{,}0001331585$.

\vspace{0.3cm}

Pri nesymetrickom intervale, v ktorom sa minimum nachádza ďalej od okraja, je už pri malom počte vyčíslení dosiahnutá lepšia presnosť v porovnaní s prípadom minima na hranici intervalu. So zvyšujúcim sa počtom vyčíslení dochádza k výraznému zúženiu výsledného intervalu a k rýchlej konvergencii k presnej hodnote minima. Tento výsledok potvrdzuje, že poloha minima v rámci počiatočného intervalu má významný vplyv na efektivitu metódy.

\vspace{0.5cm}
\noindent \underline{\textbf{Mikro interval}}
\vspace{0.5cm}

Pre východiskový interval $I_{micro} = [ 1{,}73; 1{,}76 ]$ a $N=4$ vyčíslení dostávame výsledný ILM približne ako $I_3 = [1{,}73708039; 1{,}744164079]$. Apriórny odhad maximálnej chyby je $\epsilon_{max} \doteq 0{,}003541019$. Aproximáciu minima dostávame ako bod $\tilde{x} \doteq 1{,}740623059$ s funkčnou hodnotou $f(\tilde{x}) \doteq 0{,}9450673825$. Skutočná chyba je v tomto prípade $\epsilon \doteq 0{,}0019880286$.

\vspace{0.3cm}

Pre východiskový interval $I_{micro} = [ 1{,}73; 1{,}76 ]$ a $N=20$ vyčíslení dostávame výsledný ILM približne ako $I_{19} = [1{,}742606174; 1{,}742609383]$. Apriórny odhad maximálnej chyby je $\epsilon_{max} \doteq 1{,}6044 \times10^{-6}$. Aproximáciu minima dostávame ako bod $\tilde{x} \doteq 1{,}742607778$ s funkčnou hodnotou $f(\tilde{x}) \doteq 0{,}9450581663$. Skutočná chyba je v tomto prípade $\epsilon \doteq 3{,}3096869 \times10^{-6}$.

\vspace{0.5cm}
\noindent \underline{\textbf{Obrovský interval}} 
\vspace{0.5cm}

Pre východiskový interval $I_0 = [-100; 100]$ a $N=4$ vyčíslení dostávame výsledný ILM približne ako $I_3 = [-23{,}60679794; 23{,}60679750]$. Apriórny odhad maximálnej chyby je $\epsilon_{max} \doteq 23{,}60679766$. Aproximáciu minima dostávame ako bod $\tilde{x} \doteq -2{,}2 \times10^{-7}$ s funkčnou hodnotou $f(\tilde{x}) \doteq 4{,}666667217$. Skutočná chyba je v tomto prípade $\epsilon \doteq 1{,}74261132151$.

\vspace{0.3cm}

Pre východiskový interval $I_0 = [-100; 100]$ a $N=20$ vyčíslení dostávame výsledný ILM približne ako $I_{19} = [1{,}734051255; 1{,}755443918]$. Apriórny odhad maximálnej chyby je $\epsilon_{max} \doteq 0{,}01069633079$. Aproximáciu minima dostávame ako bod $\tilde{x} \doteq 1{,}744747586$ s funkčnou hodnotou $f(\tilde{x}) \doteq 0{,}9450687923$. Skutočná chyba je v tomto prípade $\epsilon \doteq 0{,}0021356484408$.

\vspace{0.3cm}

Aj pri tomto obrovskom rozsahu šírky 200 sa ukázalo, že zlatý rez je extrémne efektívny, pretože na chybu $0{,}01$ mu stačilo len 20 meraní. Pre porovnanie, metóda polenia potrebovala na dosiahnutie tejto presnosti pri makro intervale až 50 vyčíslení. Zlatý rez teda vďaka vyššiemu počtu krokov spracuje aj takto veľké intervaly oveľa rýchlejšie a bez zbytočného plytvania.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\textwidth]{grafy/tabulka2.png}
    \label{fig:moj_obrazok}
\end{figure}

\vspace{0.3cm}

Z celého nášho testovania jasne vyplýva, že metóda zlatého rezu je efektívnejšia, pretože vďaka lepšiemu využitiu bodov dokáže urobiť takmer dvojnásobok krokov pri rovnakom počte meraní. Najväčší rozdiel sme videli pri vyššom počte vyčíslení, kde metóda polenia úplne narazila na svoj strop kvôli parametru delta, zatiaľ čo zlatý rez bez problémov pokračoval v spresňovaní až k astronomicky malým hodnotám. Ukázalo sa tiež, že hoci šírka počiatočného intervalu výrazne ovplyvňuje presnosť v úvode, zlatý rez dokáže aj obrovské intervaly spracovať oveľa rýchlejšie a s lepšou matematickou istotou než metóda polenia. Celkovo teda môžeme povedať, že ak nepotrebujeme extrémne vysokú presnosť a máme minimum v strede, metódy sú porovnateľné, ale pre akékoľvek náročnejšie výpočty je zlatý rez jednoznačne lepšou voľbou.


\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Analýza numerických metód pre funkciu viac premenných}

Na analýzu numerických metód pre funkciu viac premenných sme si zvolili funkciu
$$ f(x,y) = e^{-x} + e^{y} + (x-y^2)^2 + x, $$
ktorá je definovaná a spojitá na celom priestore $\mathbb{R}^2$. Svoje „presné“ minimum táto funkcia nadobúda v bode
$$ [x^*; y^*] \doteq [0.388128831; -0.740924056] $$
s funkčnou hodnotou
$$ f(x^*; y^*) \doteq 1.568996403. $$
Na nasledujúcich troch stranách sú potom vykreslené vrstevnicový graf a 3D graf tejto funkcie z rôznych pohľadov, ktoré ilustrujú jej tvar a globálne vlastnosti.

Pre tento projekt sme zvolili \textbf{Newtonovu metódu (NM)} a \textbf{metódu združených gradientov (MSG)}, ktorých správanie a rýchlosť konvergencie budeme pre túto funkciu analyzovať.\footnote{Používame Python, použité skripty možno nájsť na https://github.com/RadimCech/mat\_prog\_projekt}

\newpage

% --- 10. STRANA: VRSTEVNICOVÝ GRAF ---
\newpage

\begin{figure}[H]
   \centering
   \resizebox{0.8\textwidth}{!}{
   \input{grafy/graph_contours.pgf}}
   \caption{Vrstevnicový graf funkcie $f(x,y)$.}
   \label{fig:graph_contour}
\end{figure}

\vspace*{\fill}

\newpage
\thispagestyle{plain}
\vspace*{\fill}
\begin{figure}[H]
   \centering
   \resizebox{1\textwidth}{!}{
   \input{grafy/graph_surface.pgf}}
   \caption{Pohľad na graf funkcie v $\mathbb{R}^3$.}
   \label{fig:graph_surface}
\end{figure}
\vspace*{\fill}
\newpage

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\textwidth]{grafy/Pohlady.png}
    \caption{Rôzne 3D pohľady na funkciu $f(x,y)$.}
    \label{fig:moj_obrazok}
\end{figure}
\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\subsection{Newtonova metóda}

Táto metóda patrí medzi metódy druhého rádu, pretože pri hľadaní smeru poklesu využíva nielen gradient (prvé derivácie), ale aj Hessovu maticu (druhé derivácie). Hlavná myšlienka spočíva v tom, že v každom kroku funkciu $f$ aproximujeme Taylorovým polynómom druhého rádu a hľadáme jeho minimum.

Členy minimalizujúcej postupnosti $\{x^{[k]}\}$ počítame iteračným vzťahom:
$$ x^{[k+1]} = x^{[k]} - [\nabla^2 f(x^{[k]})]^{-1} \cdot \nabla f(x^{[k]}), $$
kde $\nabla f(x^{[k]})$ je gradient funkcie a $\nabla^2 f(x^{[k]})$ je Hessova matica funkcie v bode $x^{[k]}$.
Vďaka využitiu informácií o zakrivení funkcie táto metóda konverguje spravidla veľmi rýchlo (kvadraticky) v blízkosti lokálneho minima.

\subsubsection{Analýza metódy pri rôznych hodnotách počiatočnej aproximácie}

Na analýzu metódy pri rôznych počiatočných bodoch $x^{[0]}$ opäť potrebujeme vhodné ukončovacie kritérium. V súlade s teóriou volíme podmienku pre zmenu funkčnej hodnoty
$$ |f(x^{[k]}) - f(x^{[k-1]})|=\epsilon < 0{,}001. $$
Budeme teda sledovať, po koľkých krokoch sa Newtonova metóda pre rôzne $x^{[0]}$ „ukončí“.

\newpage
\noindent \textbf{Počiatočný bod} $x^{[0]} = [0; 0]$ 
\vspace{0.5cm}


Ako prvý volíme počiatok súradnicovej sústavy. Pre Newtonovu metódu očakávame veľmi rýchlu konvergenciu.

\begin{table}[h!]
    \centering
    \begin{tabular}{ccccc}
        \toprule
        \textbf{Iterácia} & \textbf{Bod } $x^{[k]}$ & \textbf{Hodnota } $f(x^{[k]})$ & \textbf{Rozdiel } $|f_k - f_{k-1}|$ \\
        \midrule
        0 & $[0.000000; 0.000000]$ & $2.000000$ & $0.367879$ \\
        1 & $[0.000000; -1.000000]$ & $2.367879$ & $0.777743$ \\
        2 & $[0.483674; -0.862755]$ & $1.590136$ & $0.020643$ \\
        3 & $[0.400337; -0.759623]$ & $1.569493$ & $0.000496$ \\
        \bottomrule
    \end{tabular}
    \caption{Priebeh NM pre $x^{[0]}=[0;0]$. Minimum nájdené v $(0.400337, -0.759623)$.}
\end{table}


\begin{figure}[H]
    \centering
    
    % --- ĽAVÝ OBRÁZOK ---
    \begin{subfigure}[b]{0.48\textwidth}
        \centering
        \resizebox{\linewidth}{!}{\input{grafy/newton_contour_1.pgf}}
        \caption{Pohľad zhora (Vrstevnice)}
        \label{fig:newton_vlavo}
    \end{subfigure}
    \hfill
    % --- PRAVÝ OBRÁZOK ---
    \begin{subfigure}[b]{0.48\textwidth}
        \centering
        \resizebox{\linewidth}{!}{\input{grafy/newton_surface_1.pgf}}
        \caption{3D graf funkcie}
        \label{fig:newton_vpravo}
    \end{subfigure}
    
    \label{fig:newton_komplet}
\end{figure}

\noindent Vidíme, že v tomto prípade metóda dosiahla požadovanú presnosť už po 3. iterácii. To potvrdzuje vysokú efektivitu Newtonovej metódy pre hladké konvexné funkcie, kedy skočí takmer priamo do minima.



\newpage
\noindent \textbf{Počiatočný bod} $x^{[0]} = [1.5; 0.5]$
\vspace{0.5cm}

Skúsme bod, ktorý je ďalej od minima a kde funkcia rastie vplyvom členu $e^y$.

\begin{table}[h!]
    \centering
    \begin{tabular}{cccc}
        \toprule
        \textbf{Iterácia} & \textbf{Bod } $x^{[k]}$ & \textbf{Hodnota } $f(x^{[k]})$ & \textbf{Rozdiel } $|f_k - f_{k-1}|$ \\
        \midrule
        0 & $[1{,}5;\;0{,}5]$ & $4{,}934351$ & $0{,}028395$ \\
        1 & $[0{,}624720;\;1{,}165504]$ & $4{,}905957$ & $1{,}941525$ \\
        2 & $[-0{,}022409;\;0{,}598473]$ & $2{,}964432$ & $0{,}810767$ \\
        3 & $[-0{,}150650;\;0{,}109123]$ & $2{,}153665$ & $0{,}432282$ \\
        4 & $[-0{,}082210;\;-0{,}512321]$ & $1{,}721383$ & $0{,}143755$ \\
        5 & $[0{,}268582;\;-0{,}662316]$ & $1{,}577628$ & $0{,}008577$ \\
        6 & $[0{,}379564;\;-0{,}738632]$ & $1{,}569051$ & $0{,}000055$ \\
        \bottomrule
    \end{tabular}
    \caption{Priebeh NM pre $x^{[0]} = [1{,}5;\;0{,}5]$.}
\end{table}



Napriek tomu, že sme zvolili počiatočný bod v oblasti s výraznejším stúpaním funkcie, metóda našla minimum pomerne hladko. Počet iterácií sa síce zvýšil na šesť, čo je dvojnásobok oproti predchádzajúcemu prípadu, no vzhľadom na vzdialenosť bodu ide stále o veľmi rýchlu konvergenciu. Grafy potvrdzujú, že algoritmus dokázal efektívne korigovať smer a padnúť do optima aj z tejto nevýhodnejšej pozície. 


\begin{figure}[H]
    \centering
    
    % --- ĽAVÝ OBRÁZOK ---
    \begin{subfigure}[b]{0.48\textwidth}
        \centering
        \resizebox{\linewidth}{!}{\input{grafy/newton_contour.pgf}}
        \caption{Pohľad zhora (Vrstevnice)}
        \label{fig:newton_vlavo}
    \end{subfigure}
    \hfill
    % --- PRAVÝ OBRÁZOK ---
    \begin{subfigure}[b]{0.48\textwidth}
        \centering
        \resizebox{\linewidth}{!}{\input{grafy/newton_surface.pgf}}
        \caption{3D graf funkcie}
        \label{fig:newton_vpravo}
    \end{subfigure}
    
    \label{fig:newton_komplet}
\end{figure}


\newpage
\noindent \textbf{Počiatočný bod} $x^{[0]} = [2; -2]$
\vspace{0.5cm}


\begin{table}[h!]
    \centering
    \begin{tabular}{ccccc}
        \toprule
        \textbf{Iterácia} &
        $\boldsymbol{x}$ &
        $\boldsymbol{y}$ &
        $\boldsymbol{f(x,y)}$ &
        $\boldsymbol{|f_k - f_{k-1}|}$ \\
        \midrule
        0 & $ 2{,}000000$ & $-2{,}000000$ & $6{,}270671$ & $3{,}623404$ \\
        1 & $ 1{,}950255$ & $-1{,}594805$ & $2{,}647267$ & $0{,}699685$ \\
        2 & $ 0{,}129873$ & $-0{,}931993$ & $1{,}947582$ & $0{,}370219$ \\
        3 & $-0{,}457773$ & $-0{,}821499$ & $1{,}577363$ & $0{,}008275$ \\
        4 & $ 0{,}392100$ & $-0{,}748534$ & $1{,}569088$ & $0{,}000092$ \\
        \bottomrule
    \end{tabular}
    \caption{Priebeh Newtonovej metódy pre $x^{[0]} = [2;\,-2]$.}
    \label{tab:newton_priebeh}
\end{table}

Aj napriek voľbe počiatočného bodu s veľkými súradnicami metóda skonvergovala už po štyroch iteráciách. Výrazný posun v prvej iterácii smerom k optimu potvrdzuje kvadratický charakter konvergencie, pričom ďalšie iterácie zabezpečili postupné spresňovanie riešenia na požadovanú presnosť.


\begin{figure}[H]
    \centering
    
    % --- ĽAVÝ OBRÁZOK ---
    \begin{subfigure}[b]{0.48\textwidth}
        \centering
        \resizebox{\linewidth}{!}{\input{grafy/newton_contour_2.pgf}}
        \caption{Pohľad zhora (Vrstevnice)}
        \label{fig:newton_vlavo}
    \end{subfigure}
    \hfill
    % --- PRAVÝ OBRÁZOK ---
    \begin{subfigure}[b]{0.48\textwidth}
        \centering
        \resizebox{\linewidth}{!}{\input{grafy/newton_surface_2.pgf}}
        \caption{3D graf funkcie}
        \label{fig:newton_vpravo}
    \end{subfigure}
    
    \label{fig:newton_komplet}
\end{figure}


Ďalej si už ukážeme tabuľku súhrnných výsledkov Newtonovej metódy pre rôzne počiatočné body.




\newpage

\begin{table}[h!]
\centering
% \resizebox{šírka}{výška (zachovať pomer)}{obsah}
\resizebox{\textwidth}{!}{%
\begin{tabular}{|c|c|c|c|c|}
\hline
\textbf{Počiatočný bod} $x^{[0]}$ & \textbf{Iterácie} ($k$) & \textbf{Nájdené minimum} $\tilde{x}$ & \textbf{Hodnota} $f(\tilde{x})$ & \textbf{Rozdiel} $|f_k - f_{k-1}|$ \\ \hline
$[0.0; 0.0]$     & 3 & $[0.4003; -0.7596]$ & $1,569493$ & $0,000496$ \\ \hline
$[1.5; 0.5]$     & 6 & $[0.3796; -0.7386]$ & $1,569051$ & $0,000055$ \\ \hline
$[2.0; -2.0]$    & 4 & $[0.3921; -0.7485]$ & $1,569088$ & $0,000092$ \\ \hline
$[-1.0; -1.0]$   & 4 & $[0.3902; -0.7437]$ & $1,569006$ & $0,000028$ \\ \hline
$[-1.0; 1.0]$    & 5 & $[0.3826; -0.7352]$ & $1,569075$ & $0,000227$ \\ \hline
$[2.0; 2.0]$     & 6 & $[0.3829; -0.7354]$ & $1,569070$ & $0,000204$ \\ \hline
$[-2.0; -2.0]$   & 5 & $[0.3890; -0.7420]$ & $1,569001$ & $0,000010$ \\ \hline
$[0.5; -1.0]$    & 2 & $[0.3851; -0.7368]$ & $1,569022$ & $0,000063$ \\ \hline
$[3.0; 0.0]$     & 5 & $[0.3832; -0.7359]$ & $1,569064$ & $0,000188$ \\ \hline
$[0.0; 2.0]$     & 6 & $[0.3818; -0.7341]$ & $1,569092$ & $0,000277$ \\ \hline
$[5.0; 5.0]$     & 8 & $[0.3822; -0.7348]$ & $1,569080$ & $0,000150$ \\ \hline
$[-5.0; -5.0]$   & 7 & $[0.3895; -0.7429]$ & $1,569003$ & $0,000012$ \\ \hline
$[10.0; 0.0]$    & 9 & $[0.3835; -0.7362]$ & $1,569061$ & $0,000210$ \\ \hline
\end{tabular}%
}
\caption{Súhrnné výsledky Newtonovej metódy pre blízke aj vzdialené body}
\label{tab:newton_results_extended}
\end{table}

Je zrejmé, že aj pri extrémnom počiatočnom bode $[10; 0]$ metóda skonvergovala už po 9 iteráciách. To naznačuje, že Newtonova metóda je pre túto funkciu veľmi stabilná a dokáže efektívne pracovať aj pri veľkej vzdialenosti od optima, najmä vďaka presnej informácii o zakrivení poskytovanej Hessovou maticou.

Naskytuje sa otázka, ako moc by sa zmenili iterácie, keby sme zvolili  $\epsilon = 10^{-6}$, teda sprísnené ukončovacie kritérium. Výsledky môžeme vidieť v nasledujúcej tabuľke

\begin{table}[H]
\centering
% \resizebox{šírka}{výška (zachovať pomer)}{obsah}
\resizebox{\textwidth}{!}{%
\begin{tabular}{|c|c|c|c|}
\hline
\textbf{Počiatočný bod} $x^{[0]}$ & \textbf{Iterácie} ($k$) & \textbf{Nájdené minimum} $\tilde{x}$ & \textbf{Hodnota} $f(\tilde{x})$  \\ \hline
$[0.0; 0.0]$     & 4 & $[0.3881; -0.7409]$ & $1,568996$ \\ \hline
$[1.5; 0.5]$     & 7 & $[0.3881; -0.7409]$ & $1,568996$  \\ \hline
$[2.0; -2.0]$    & 5 & $[0.3881; -0.7409]$ & $1,568996$  \\ \hline
$[-1.0; -1.0]$   & 5 & $[0.3881; -0.7409]$ & $1,568996$  \\ \hline
$[-1.0; 1.0]$    & 6 & $[0.3881; -0.7409]$ & $1,568996$  \\ \hline
$[2.0; 2.0]$     & 7 & $[0.3881; -0.7409]$ & $1,568996$  \\ \hline
$[-2.0; -2.0]$   & 6 & $[0.3881; -0.7409]$ & $1,568996$  \\ \hline
$[0.5; -1.0]$    & 3 & $[0.3881; -0.7409]$ & $1,568996$  \\ \hline
$[3.0; 0.0]$     & 6 & $[0.3881; -0.7409]$ & $1,568996$  \\ \hline
$[0.0; 2.0]$     & 7 & $[0.3881; -0.7409]$ & $1,568996$  \\ \hline
$[5.0; 5.0]$     & 9 & $[0.3881; -0.7409]$ & $1,568996$  \\ \hline
$[-5.0; -5.0]$   & 8 & $[0.3881; -0.7409]$ & $1,568996$  \\ \hline
$[10.0; 0.0]$    & 10 & $[0.3881; -0.7409]$ & $1,568996$  \\ \hline
\end{tabular}%
}
\caption{Súhrnné výsledky Newtonovej metódy pre sprísnené kritérium $\epsilon = 10^{-6}$}
\label{tab:newton_results_strict}
\end{table}

Vidíme, že pre Newtonovu metódu je nastavenie $\epsilon = 0{,}001$ pomerne benevolentné. Vzhľadom na jej obrovskú rýchlosť by nastavenie $\epsilon = 10^{-6}$ stálo len zanedbateľný výpočtový čas navyše (maximálne 1-2 iterácie navyše), no prinieslo by oveľa presnejšie výsledky. Pri pomalších metódach (ako metoda najväčšieho spádu) by však sprísnenie kritéria mohlo znamenať stovky iterácií navyše.

\newpage

\subsection{Metóda združených gradientov (MSG)}

Táto metóda, v skriptách označovaná ako MSG, bola pôvodne navrhnutá pre riešenie sústav lineárnych rovníc s pozitívne definitnou maticou (čo zodpovedá minimalizácii kvadratickej funkcie). Pre kvadratické funkcie v $\mathbb{R}^n$ nájde MSG presné minimum najviac v $n$ krokoch.

Pre všeobecné nekvadratické funkcie (náš prípad) sa metóda modifikuje tak, že nový smer hľadania $h_k$ vhodne konštruujeme ako lineárnu kombináciu aktuálneho záporu gradientu a predchádzajúceho smeru
$$ h_k = - \nabla f(x^{[k]}) + \beta_{k-1} h_{k-1}, $$
kde pre prvý krok volíme $h_0 = -\nabla f(x^{[0]})$.
Koeficient $\beta_{k-1}$ zabezpečuje, aby boli smery združené. V našej analýze využijeme \textit{Fletcherov-Reevesov} vzorec
$$ \beta_{k-1}^{FR} = \frac{\|\nabla f(x^{[k]})\|^2}{\|\nabla f(x^{[k-1]})\|^2}. $$
Metóda sa pri nekvadratických funkciách zvyčajne po $n$ krokoch reštartuje (položí sa $\beta = 0$), aby sa eliminovali kumulované chyby a zachovala konvergencia. Štandardne sa volí dĺžka cyklu pred resetom $\beta$ tak, aby zodpovedala počtu premenných minimalizovanej funkcie. Hodnota $\beta_{k-1}$ sa teda bude rovnať $0$ pri každej párnej iterácii, t. j. pre $k = 2n, n \in \mathbb{N}_0$.

\vspace{0.3cm}

\noindent {\Large \textbf{Analýza metódy pri rôznych hodnotách počiatočnej aproximácie}}

\vspace{0.3cm}

Teraz sa zameriame na analýzu metódy združených gradientov v závislosti od rôznych počiatočných bodov iteračného procesu. Súbežne budeme skúmať variant MSG bez resetu, ako aj MSG s resetovaním hodnoty $\beta$ s dĺžkou cyklu 2, čo predstavuje štandardnú dĺžku vzhľadom na počet premenných funkcie $f(x, y)$.
Porovnanie vykonáme pre rovnaké počiatočné body ako pri Newtonovej metóde.
Opäť volíme ukončovaciu podmienku vzhľadom na zmenu funkčnej hodnoty
$$ |f(x^{[k]}) - f(x^{[k-1]})|=\epsilon < 0{,}001. $$
Naším cieľom bude sledovať počet krokov (iterácií), ktoré metóda potrebuje na dosiahnutie tohto kritéria pre rôzne zvolené body $x^{[0]}$.

%!!!!!!!!!!!!!!!!!!!!!!!!!!TREBA SPRAVIŤ AJ S TÝM RESETOM BETA!!!!!!!!!!!!!)))))))))))

\newpage
\subsubsection{MSG s nulováním $\beta$ po dvou iteracích}

\noindent \textbf{Počiatočný bod} $x^{[0]} = [0; 0]$ \\

\begin{table}[H]
    \centering
    \begin{tabular}{cccc}
        \toprule
        \textbf{Iterácia} & \textbf{Bod } $x^{[k]} = [x;y]$ & \textbf{Hodnota } $f(x^{[k]})$ & \textbf{Norma } $\|\nabla f\|$ \\
        \midrule
        0  & $[0.000000;\; 0.000000]$   & 2.000000 & -- \\
        1  & $[0.000000;\; -0.500000]$  & 1.669031 & 1.000000 \\
        2  & $[0.250000;\; -0.553265]$  & 1.607017 & 0.511223 \\
        \dots & \dots & \dots & \dots \\
        13 & $[0.388215;\; -0.741333]$  & 1.568997 & 0.015403 \\
        14 & $[0.388461;\; -0.740832]$  & 1.568997 & 0.002233 \\
        15 & $[0.388004;\; -0.740889]$  & 1.568996 & 0.001887 \\
        \bottomrule
    \end{tabular}
    \caption{Priebeh MSG pre $x^{[0]} = [0;0]$.}
\end{table}

Pri tomto počiatočnom bode vidíme výrazný rozdiel oproti Newtonovej metóde – konvergencia tu trvala až 15 iterácií, zatiaľ čo Newton to zvládol za 3. Graf ukazuje, ako sa metóda postupne približuje k minimu jemnejším cik-cak pohybom, čo je daň za to, že nepoužívame informácie z druhých derivácií (Hessovu maticu). Pravidelný reštart parametra $\beta$ každé dva kroky tu zjavne funguje a udržuje metódu stabilnú, aj keď je pomalšia.

\begin{figure}[H]
    \centering

    \begin{subfigure}{0.48\textwidth}
        \centering
        \resizebox{\linewidth}{!}{\input{grafy/cg_contour_1.pgf}}
        \caption{Pohľad zhora (Vrstevnice)}
        \label{fig:newton_vlavo}
    \end{subfigure}
    \hfill
    \begin{subfigure}{0.48\textwidth}
        \centering
        \resizebox{\linewidth}{!}{\input{grafy/cg_surface_1.pgf}}
        \caption{3D graf funkcie}
        \label{fig:newton_vpravo}
    \end{subfigure}

    \label{fig:newton_komplet}
\end{figure}



\newpage
\noindent \textbf{Počiatočný bod} $x^{[0]} = [1.5; 0.5]$ \\
V tomto prípade je funkcia strmšia (vplyvom exponenciály), čo môže ovplyvniť veľkosť kroku v prvej iterácii.

\begin{table}[h!]
    \centering
    \begin{tabular}{cccc}
        \toprule
        \textbf{Iterácia} & \textbf{Bod } $x^{[k]} = [x;y]$ & \textbf{Hodnota } $f(x^{[k]})$ & \textbf{Norma } $\|\nabla f\|$ \\
        \midrule
        0  & $[1.500000;\; 0.500000]$   & 4.934351 & -- \\
        1  & $[-0.138435;\; 0.925639]$  & 4.524030 & 3.385639 \\
        2  & $[0.396305;\; -0.626467]$  & 1.603598 & 6.566560 \\
        \dots & \dots & \dots & \dots \\
        9  & $[0.387814;\; -0.741050]$  & 1.568997 & 0.015270 \\
        10 & $[0.388119;\; -0.740641]$  & 1.568997 & 0.002043 \\
        11 & $[0.388183;\; -0.740998]$  & 1.568996 & 0.001725 \\
        \bottomrule
    \end{tabular}
    \caption{Priebeh MSG pre $x^{[0]} = [1.5;0.5]$.}
\end{table}

\begin{figure}[H]
    \centering

    \begin{subfigure}{0.48\textwidth}
        \centering
        \resizebox{\linewidth}{!}{\input{grafy/cg_contour.pgf}}
        \caption{Pohľad zhora (Vrstevnice)}
        \label{fig:newton_vlavo}
    \end{subfigure}
    \hfill
    \begin{subfigure}{0.48\textwidth}
        \centering
        \resizebox{\linewidth}{!}{\input{grafy/cg_surface.pgf}}
        \caption{3D graf funkcie}
        \label{fig:newton_vpravo}
    \end{subfigure}

    \label{fig:newton_komplet}
\end{figure}

Na vrstevnicovom grafe je pekne vidieť, ako po prvotných dlhých skokoch metóda spomalí a už len jemne dolaďuje polohu v okolí minima. Hoci sme potrebovali viac krokov než pri Newtonovej metóde, výhodou je, že výpočet každej iterácie bol výrazne jednoduchší bez potreby invertovania matice.

\newpage
\noindent \textbf{Počiatočný bod} $x^{[0]} = [2; -2]$ \\
Z tohto bodu sa metóda potrebuje vymotať z údolia.

\begin{table}[H]
    \centering
    \begin{tabular}{cccc}
        \toprule
        \textbf{Iterácia} & \textbf{Bod } $x^{[k]} = [x;y]$ & \textbf{Hodnota } $f(x^{[k]})$ & \textbf{Norma } $\|\nabla f\|$ \\
        \midrule
        0  & $[0.000000;\; 0.000000]$   & 2.000000 & -- \\
        1  & $[0.000000;\; -0.500000]$  & 1.669031 & 1.000000 \\
        2  & $[0.250000;\; -0.553265]$  & 1.607017 & 0.511223 \\
        \dots & \dots & \dots & \dots \\
        13 & $[0.388215;\; -0.741333]$  & 1.568997 & 0.015403 \\
        14 & $[0.388461;\; -0.740832]$  & 1.568997 & 0.002233 \\
        15 & $[0.388004;\; -0.740889]$  & 1.568996 & 0.001887 \\
        \bottomrule
    \end{tabular}
    \caption{Priebeh MSG pre $x^{[0]} = [0;0]$.}
\end{table}

Na grafe vidíme výrazný cik-cak pohyb, pretože metóda musela mnohokrát korigovať smer, aby sa udržala v klesajúcom koryte funkcie. Kým Newtonova metóda vďaka znalosti zakrivenia (Hessiánu) prekonala tento úsek v podstate jedným skokom, MSG sa k minimu musela prepracovať postupne, čo vysvetľuje vyšší počet iterácií.

\begin{figure}[H]
    \centering

    \begin{subfigure}{0.48\textwidth}
        \centering
        \resizebox{\linewidth}{!}{\input{grafy/cg_contour_2.pgf}}
        \caption{Pohľad zhora (Vrstevnice)}
        \label{fig:newton_vlavo}
    \end{subfigure}
    \hfill
    \begin{subfigure}{0.48\textwidth}
        \centering
        \resizebox{\linewidth}{!}{\input{grafy/cg_surface_2.pgf}}
        \caption{3D graf funkcie}
        \label{fig:newton_vpravo}
    \end{subfigure}

    \label{fig:newton_komplet}
\end{figure}


\newpage
\subsubsection{MSG bez nulování $\beta$}


\noindent \textbf{Počiatočný bod} $x^{[0]} = [0; 0]$ \\

\begin{table}[H]
    \centering
    \begin{tabular}{cccc}
        \toprule
        \textbf{Iterácia} & \textbf{Bod } $x^{[k]} = [x;y]$ & \textbf{Hodnota } $f(x^{[k]})$ & \textbf{Norma } $\|\nabla f\|$ \\
        \midrule
        0  & $[0.000000;\; 0.000000]$   & 2.000000 & -- \\
        1  & $[0.000000;\; -0.500000]$  & 1.669031 & 1.000000 \\
        2  & $[0.250000;\; -0.553265]$  & 1.607017 & 0.511223 \\
        \dots & \dots & \dots & \dots \\
        18 & $[0.390938;\; -0.743091]$ & 1.569002 & 0.011786 \\
        19 & $[0.391029;\; -0.742336]$ & 1.569001 & 0.003799 \\
        20 & $[0.387794;\; -0.740333]$ & 1.568997 & 0.003664 \\
        \bottomrule
    \end{tabular}
    \caption{Priebeh MSG pre $x^{[0]} = [0;0]$.}
\end{table}

Tu sa ukázalo, že vynechanie pravidelného nulovania parametra $\beta$ má na konvergenciu negatívny vplyv. Počet iterácií narástol na 20, čo je o tretinu viac ako v prípade s resetom (kde to bolo 15). Je vidieť, že bez reštartu sa v smere hľadania postupne kumulujú chyby a metóda stráca svoju efektivitu, kým sa konečne trafí do presného minima.


\begin{figure}[H]
    \centering

    \begin{subfigure}{0.48\textwidth}
        \centering
        \resizebox{\linewidth}{!}{\input{grafy/cg_contour_10.pgf}}
        \caption{Pohľad zhora (Vrstevnice)}
        \label{fig:newton_vlavo}
    \end{subfigure}
    \hfill
    \begin{subfigure}{0.48\textwidth}
        \centering
        \resizebox{\linewidth}{!}{\input{grafy/cg_surface_10.pgf}}
        \caption{3D graf funkcie}
        \label{fig:newton_vpravo}
    \end{subfigure}

    \label{fig:newton_komplet}
\end{figure}



\newpage
\noindent \textbf{Počiatočný bod} $x^{[0]} = [1.5; 0.5]$ \\

\begin{table}[H]
    \centering
    \begin{tabular}{cccc}
        \toprule
        \textbf{Iterácia} & \textbf{Bod } $x^{[k]} = [x;y]$ & \textbf{Hodnota } $f(x^{[k]})$ & \textbf{Norma } $\|\nabla f\|$ \\
        \midrule
        0  & $[1.500000;\; 0.500000]$   & 4.943351 & -- \\
        1  & $[-0.138435;\; 0.925639]$  & 4.524030 & 3.385639 \\
        2  & $[0.396305;\; -0.626467]$  & 1.603598 & 6.566560 \\
        \dots & \dots & \dots & \dots \\
        18 & $[0.389757;\; -0.742198]$ & 1.568998 & 0.006963 \\
        19 & $[0.389926;\; -0.741981]$ & 1.568998 & 0.002284 \\
        20 & $[0.389487;\; -0.741218]$ & 1.568998 & 0.001749 \\
        \dots & \dots & \dots & \dots \\
        25 & $[0.388632;\; -0.741332]$ & 1.568997 & 0.002571 \\
        \bottomrule
    \end{tabular}
    \caption{Priebeh MSG pre $x^{[0]} = [1.5;\;0.5]$.}
\end{table}

Pri tomto počiatočnom bode sa výrazne prejavila nevýhoda absencie reštartov, keďže počet iterácií vzrástol až na 25. Ide o viac než dvojnásobok v porovnaní s verziou s resetovaním, ktorá dosiahla konvergenciu už po 11 krokoch. Bez vynulovania parametra $\beta$ sa smery vyhľadávania stávajú menej efektívnymi, čo vedie k spomaleniu konvergencie v záverečnej fáze v okolí minima, čo je zároveň viditeľné aj na zvýšenej hustote bodov na grafe.


\begin{figure}[H]
    \centering

    \begin{subfigure}{0.48\textwidth}
        \centering
        \resizebox{\linewidth}{!}{\input{grafy/cg_contour_11.pgf}}
        \caption{Pohľad zhora (Vrstevnice)}
        \label{fig:newton_vlavo}
    \end{subfigure}
    \hfill
    \begin{subfigure}{0.48\textwidth}
        \centering
        \resizebox{\linewidth}{!}{\input{grafy/cg_surface_11.pgf}}
        \caption{3D graf funkcie}
        \label{fig:newton_vpravo}
    \end{subfigure}

    \label{fig:newton_komplet}
\end{figure}


\newpage

\begin{table}[htbp]
\centering
\footnotesize
\begin{tabular}{|c|c|c|c|c|c|}
\hline
\textbf{Poč. bod} $x^{[0]}$ & \textbf{Iter (Reset)} & \textbf{Iter (Bez)} & \textbf{Minimum} $\tilde{x}$ & \textbf{Hodnota} & \textbf{Rozdiel} \\ \hline
$[0.0; 0.0]$     & 15 & 20 & $[0.3880; -0.7409]$ & $1,568996$ & $0,001887$ \\ \hline
$[1.5; 0.5]$     & 11 & 25 & $[0.3882; -0.7410]$ & $1,568996$ & $0,001725$ \\ \hline
$[2.0; -2.0]$    & 13 & 22 & $[0.3885; -0.7405]$ & $1,568998$ & $0,001540$ \\ \hline
$[-1.0; -1.0]$   & 12 & 19 & $[0.3879; -0.7412]$ & $1,568999$ & $0,001220$ \\ \hline
$[-1.0; 1.0]$    & 14 & 26 & $[0.3883; -0.7408]$ & $1,568997$ & $0,001650$ \\ \hline
$[2.0; 2.0]$     & 16 & 35 & $[0.3878; -0.7415]$ & $1,569002$ & $0,001910$ \\ \hline
$[-2.0; -2.0]$   & 14 & 21 & $[0.3884; -0.7406]$ & $1,568998$ & $0,001480$ \\ \hline
$[0.5; -1.0]$    & 7  & 9  & $[0.3881; -0.7409]$ & $1,568996$ & $0,000950$ \\ \hline
$[3.0; 0.0]$     & 15 & 28 & $[0.3886; -0.7404]$ & $1,569005$ & $0,001820$ \\ \hline
$[0.0; 2.0]$     & 18 & 31 & $[0.3875; -0.7418]$ & $1,569010$ & $0,001950$ \\ \hline
\end{tabular}
\caption{Porovnanie konvergencie MSG}
\end{table}

Vo všetkých testovaných prípadoch dosiahla verzia s resetom výsledok rýchlejšie. Najvýraznejší rozdiel vidíme pri bode $[2.0; 2.0]$ (16 vs. 35 iterácií) a $[1.5; 0.5]$ (11 vs. 25 iterácií). Bez resetu má metóda tendenciu generovať smery, ktoré po mnohých krokoch strácajú vlastnosť združenosti (kvôli nekvadratickej povahe funkcie), čo spomaľuje postup k minimu.

Zatiaľ čo Newtonova metóda potrebovala na nájdenie minima len cca 3 až 6 krokov, MSG s resetom potrebuje priemerne 11 až 18 krokov. To potvrdzuje teóriu, že MSG (metóda prvého rádu) je pomalšia než Newtonova metóda (metóda druhého rádu), avšak jej výhodou je, že nevyžaduje výpočet a inverziu Hessovej matice.

\end{document}
